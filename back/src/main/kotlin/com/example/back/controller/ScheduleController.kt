package com.example.back.controller

import com.example.back.dto.Schedule
import com.example.back.dto.ScheduleReq
import com.example.back.dto.ScheduleRes
import com.example.back.service.ScheduleService
import io.swagger.annotations.Api
import io.swagger.annotations.ApiOperation
import org.bson.types.ObjectId
import org.springframework.web.bind.annotation.*

@Api(description = "일정관리")
@RestController
@RequestMapping("api/")
class ScheduleController (
    val scheduleService:ScheduleService
)
{
    @ApiOperation(value = "유저 일정확인", notes = "유저 일정 확인 GET API")
    @GetMapping(path = ["schedule/{userid}"])
    fun getSchedule(@PathVariable userid:String):List<ScheduleRes>{
        return scheduleService.findScheduleByUserId(userid)
    }

    @ApiOperation(value = "유저 일정확인(제목)", notes = "유저 일정 확인 GET API")
    @GetMapping(path = ["schedule/{userid}/{title}"])
    fun getSchedule(@PathVariable userid:String,@PathVariable title:String):List<ScheduleRes>{
        return scheduleService.findScheduleByUserId(userid)
    }

    @ApiOperation(value = "유저 일정 생성", notes = "유저 일정 생성 POST API")
    @PostMapping(path = ["schedule"])
    fun insertSchedule(@RequestBody schedule: ScheduleReq): ScheduleRes {
        return scheduleService.createShcedule(schedule)
    }

    @PutMapping(path=["schedule/{id}"])
    fun updateSchedule(@RequestBody schedule: Schedule,@PathVariable id:String):Schedule{
        return scheduleService.updateScheduleById(schedule,ObjectId(id))
    }

    @DeleteMapping(path=["schedule/{id}"])
    fun deleteSchedule(@RequestBody schedule: Schedule,@PathVariable id:String):Schedule{
        return scheduleService.updateScheduleById(schedule,ObjectId(id))
    }
}